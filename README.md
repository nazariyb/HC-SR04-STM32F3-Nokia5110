Encoding=UTF-8<br/>
## Пристрій для визначення відстані за допомогою __HC-SR04__ на __STM32F303VC__ і виводом на екран __Nokia 5110__ <br/>
Використовув 2 таймери: **TIM3** (канали 1 та 2, _input capture direct/indirect mode_) для отримання __ECHO__ через переривання  та **TIM1** (канал 3, _PWM Generation CH3_) для відправлення __PWM__ сигналу на __Trig__. Оскільки я налаштував швидкість процесора на максимальну - __72MHz__, то параметер __Prescaler__ для таймерів поставив 71, щоб таймер рахував раз на (72 / (71 + 1)) мікросекунду.  <br/>
З функціями обробниками все досить зрозуміло - __*HAL_TIM_PeriodElapsedCallback()*__ перевіряє чи було очікування на імпульс, каже решті програми, що його не було; якщо ж почався, але не закінчився - переходить до відповідного стану.
__*HAL_TIM_IC_CaptureCallback()*__ перевіряє, куди прийшов імпульс, якщо на першомий канал, то просто чекає на його завершення, якщо на другий, то це кінець імпульсу і функція збергіає час тривалості імпульсу.<br/>
У *main()* та у самому *while(1)* спочатку перевіряється чи програма не є у якомусь із "поганих станів" (таких, як очікування сигналу ехо, висока напргуа на ехо перед тим, як відіслали сигнал на тріггер і т. п.).<br/>
Коли ж ми успішно відправили сигнал на *Trig* та отримали відповідь від *Echo* в проміжку *15-38* секунд від моменту подання сигналу на тріггер, то ділимо *швидкість звуку * 2*, оскільки маємо час шляху *туди + назад*, отримуємо відстань у міліметрах. Залежно від відстані переводимо її у підходящі одиниці (*мм, см, м*) і виводимо інформацію на екран нокії (вивід повідомлень про помилки також здійснюються на екран).<br/>
З екраном ситуація максимально проста - ініціалізація та налаштування по туторіалу, вони стандартні, а далі написав функцію-макрос __*print_lcd()*__, яка чистить екран, ставить курсор на початок і виводить передане їй повідомлення. Для форматованого виводу аналогу не писав. Також у налаштуваннях проекту додав відповідний прапорець для лінкера для виводу чисел із плавачою комою. Для спілкування з ерканом налаштований __SPI__<br/>
І схема підключення:<br/>
![alt text](https://github.com/nazariyb/HC-SR04-STM32F3-Nokia5110/blob/master/scheme.jpg)